<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™å­¸è¨“ç·´è¨ˆç•«ä¸»æŒäººå·¥ä½œåŠ ğŸš€</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            overflow-x: hidden;
            /* å°‡ç…§ç‰‡è¨­ç‚ºå…¨è¢å¹•å›ºå®šèƒŒæ™¯ï¼Œä¸¦åŠ ä¸Šæ·±è‰²é®ç½©ç¢ºä¿æ–‡å­—æ¸…æ™° */
            background-image: 
                linear-gradient(to bottom, rgba(30, 27, 75, 0.8), rgba(88, 28, 135, 0.85)),
                url('https://raw.githubusercontent.com/linmenggann/TrainingWorkshop4/main/DSC00045.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        /* è‡ªè¨‚éš±è—åŸç”Ÿ Radioï¼Œæ”¹ç”¨æ¨™ç±¤æ¨£å¼ */
        input[type="radio"]:checked + label {
            background-color: #9333ea; /* Purple 600 */
            color: white;
            border-color: #9333ea;
            box-shadow: 0 4px 14px 0 rgba(147, 51, 234, 0.39);
        }
        
        /* æ¯›ç»ç’ƒæ•ˆæœå¢å¼·ï¼šè®“è¡¨å–®æœ¬èº«åŠé€æ˜ï¼Œé€å‡ºå¾Œæ–¹ç…§ç‰‡ */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="min-h-screen relative flex justify-center items-center py-10 px-4 sm:px-6 lg:px-8">

    <!-- ä¸»å¡ç‰‡å®¹å™¨ -->
    <main class="glass-card w-full max-w-3xl rounded-3xl shadow-2xl relative z-10 overflow-hidden transform transition-all duration-300 hover:shadow-purple-500/50">
        
        <!-- é ‚éƒ¨è¦–è¦ºæ©«å¹… -->
        <header class="bg-gradient-to-r from-purple-600/90 to-pink-500/90 p-8 text-center text-white backdrop-blur-sm border-b border-white/20">
            <h1 class="text-3xl sm:text-4xl font-black mb-3 tracking-wide drop-shadow-md">ğŸ“ æ•™å­¸è¨“ç·´è¨ˆç•«ä¸»æŒäººå·¥ä½œåŠ ğŸš€</h1>
            <p class="text-purple-100 font-medium text-lg">èª æ‘¯é‚€è«‹æ‚¨çš„åƒèˆ‡ï¼Œå…±å‰µå“è¶Šæ•™å­¸å“è³ªï¼ âœ¨</p>
        </header>

        <!-- æ´»å‹•è³‡è¨Šå€å¡Š -->
        <section class="bg-purple-50/80 p-6 mx-6 mt-6 rounded-2xl border border-purple-100 shadow-inner">
            <h2 class="text-xl font-bold text-purple-800 mb-4 flex items-center">
                <span class="bg-purple-200 p-2 rounded-full mr-2">ğŸ“Œ</span> æ´»å‹•è³‡è¨Š
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700 font-medium">
                <div class="flex items-center space-x-3 bg-white/80 p-3 rounded-lg shadow-sm">
                    <span class="text-2xl">ğŸ“…</span>
                    <div>
                        <span class="block text-xs text-gray-500">æ—¥æœŸ</span>
                        <span class="text-gray-800 font-bold">2026/01/25</span>
                    </div>
                </div>
                <div class="flex items-center space-x-3 bg-white/80 p-3 rounded-lg shadow-sm">
                    <span class="text-2xl">â°</span>
                    <div>
                        <span class="block text-xs text-gray-500">æ™‚é–“</span>
                        <span class="text-gray-800 font-bold">9:00 ~ 16:00</span>
                    </div>
                </div>
                <div class="flex items-center space-x-3 bg-white/80 p-3 rounded-lg shadow-sm md:col-span-2">
                    <span class="text-2xl">ğŸ“</span>
                    <div>
                        <span class="block text-xs text-gray-500">åœ°é»</span>
                        <span class="text-gray-800 font-bold">å¥‡ç¾é†«é™¢ ç¬¬äº”é†«ç™‚å¤§æ¨“ 6æ¨“ 563æœƒè­°å®¤</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- å ±åè¡¨å–® -->
        <form id="registrationForm" class="p-6 sm:p-8 space-y-6">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- å§“å -->
                <div class="space-y-2">
                    <label class="block text-gray-700 font-bold">ğŸ‘¤ å§“å</label>
                    <input type="text" name="name" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-4 focus:ring-purple-300 focus:border-purple-500 transition-all bg-white/70 focus:bg-white" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
                </div>
                <!-- è¯ç¹«é›»è©± -->
                <div class="space-y-2">
                    <label class="block text-gray-700 font-bold">ğŸ“ è¯ç¹«é›»è©±</label>
                    <input type="tel" name="phone" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-4 focus:ring-purple-300 focus:border-purple-500 transition-all bg-white/70 focus:bg-white" placeholder="ä¾‹: 0912-345-678">
                </div>
            </div>

            <!-- Email -->
            <div class="space-y-2">
                <label class="block text-gray-700 font-bold">ğŸ“§ Email</label>
                <input type="email" name="email" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-4 focus:ring-purple-300 focus:border-purple-500 transition-all bg-white/70 focus:bg-white" placeholder="example@email.com">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- æ©Ÿæ§‹å -->
                <div class="space-y-2">
                    <label class="block text-gray-700 font-bold">ğŸ¥ æ©Ÿæ§‹å</label>
                    <input type="text" name="institution" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-4 focus:ring-purple-300 focus:border-purple-500 transition-all bg-white/70 focus:bg-white" placeholder="è«‹è¼¸å…¥æ©Ÿæ§‹åç¨±">
                </div>
                <!-- è·ç¨± -->
                <div class="space-y-2">
                    <label class="block text-gray-700 font-bold">ğŸ’¼ è·ç¨±</label>
                    <input type="text" name="jobTitle" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-4 focus:ring-purple-300 focus:border-purple-500 transition-all bg-white/70 focus:bg-white" placeholder="è«‹è¼¸å…¥æ‚¨çš„è·ç¨±">
                </div>
            </div>

            <!-- è² è²¬çš„è·é¡ (ä¸‹æ‹‰é¸å–®) -->
            <div class="space-y-2">
                <label class="block text-gray-700 font-bold">ğŸ©º è² è²¬çš„è·é¡</label>
                <div class="relative">
                    <select name="jobCategory" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-4 focus:ring-purple-300 focus:border-purple-500 transition-all bg-white/70 focus:bg-white appearance-none cursor-pointer">
                        <option value="" disabled selected>è«‹é¸æ“‡æ‚¨çš„è·é¡...</option>
                        <option value="è—¥äº‹">ğŸ’Š è—¥äº‹</option>
                        <option value="é†«äº‹æ”¾å°„">â˜¢ï¸ é†«äº‹æ”¾å°„</option>
                        <option value="é†«äº‹æª¢é©—">ğŸ”¬ é†«äº‹æª¢é©—</option>
                        <option value="è­·ç†">ğŸ’‰ è­·ç†</option>
                        <option value="ç‡Ÿé¤Š">ğŸ¥— ç‡Ÿé¤Š</option>
                        <option value="å‘¼å¸æ²»ç™‚">ğŸ« å‘¼å¸æ²»ç™‚</option>
                        <option value="è½åŠ›">ğŸ‘‚ è½åŠ›</option>
                        <option value="ç‰©ç†æ²»ç™‚">ğŸƒâ€â™‚ï¸ ç‰©ç†æ²»ç™‚</option>
                        <option value="è·èƒ½æ²»ç™‚">ğŸ§© è·èƒ½æ²»ç™‚</option>
                        <option value="è‡¨åºŠå¿ƒç†">ğŸ§  è‡¨åºŠå¿ƒç†</option>
                        <option value="èªè¨€æ²»ç™‚">ğŸ—£ï¸ èªè¨€æ²»ç™‚</option>
                        <option value="å…¶ä»–">ğŸ”¹ å…¶ä»–</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                </div>
            </div>

            <!-- æ˜¯å¦æ“”ä»»ä¸»æŒäºº -->
            <div class="space-y-3">
                <label class="block text-gray-700 font-bold">ğŸ™‹ æ‚¨ç›®å‰æ˜¯å¦æ“”ä»»æ•™å­¸è¨“ç·´è¨ˆç•«ä¸»æŒäººï¼Ÿ</label>
                <div class="flex space-x-4">
                    <div class="flex-1">
                        <input type="radio" id="director-yes" name="isDirector" value="æ˜¯" class="hidden" required>
                        <label for="director-yes" class="block text-center cursor-pointer border-2 border-purple-200 text-purple-600 bg-purple-50/80 py-3 rounded-xl font-bold transition-all duration-200 hover:bg-purple-100">
                            âœ¨ æ˜¯ï¼Œç›®å‰æ“”ä»»
                        </label>
                    </div>
                    <div class="flex-1">
                        <input type="radio" id="director-no" name="isDirector" value="å¦" class="hidden">
                        <label for="director-no" class="block text-center cursor-pointer border-2 border-purple-200 text-purple-600 bg-purple-50/80 py-3 rounded-xl font-bold transition-all duration-200 hover:bg-purple-100">
                            ğŸŒ± å¦ï¼Œå°šæœªæ“”ä»»
                        </label>
                    </div>
                </div>
            </div>

            <!-- åƒèˆ‡æ–¹å¼ -->
            <div class="space-y-3">
                <label class="block text-gray-700 font-bold">ğŸ’» æ‚¨é è¨ˆä»¥ä½•ç¨®æ–¹å¼åƒèˆ‡ï¼Ÿ</label>
                <div class="flex space-x-4">
                    <div class="flex-1">
                        <input type="radio" id="mode-physical" name="participationMode" value="å¯¦é«”" class="hidden" required>
                        <label for="mode-physical" class="block text-center cursor-pointer border-2 border-purple-200 text-purple-600 bg-purple-50/80 py-3 rounded-xl font-bold transition-all duration-200 hover:bg-purple-100">
                            ğŸ¢ å¯¦é«”åƒèˆ‡
                        </label>
                    </div>
                    <div class="flex-1">
                        <input type="radio" id="mode-online" name="participationMode" value="ç·šä¸Š" class="hidden">
                        <label for="mode-online" class="block text-center cursor-pointer border-2 border-purple-200 text-purple-600 bg-purple-50/80 py-3 rounded-xl font-bold transition-all duration-200 hover:bg-purple-100">
                            ğŸŒ ç·šä¸Šåƒèˆ‡
                        </label>
                    </div>
                </div>
            </div>

            <!-- é€å‡ºæŒ‰éˆ• -->
            <div class="pt-4">
                <button id="submitBtn" type="submit" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold py-4 rounded-xl shadow-lg transform transition-all duration-200 hover:scale-[1.02] active:scale-[0.98] text-lg flex justify-center items-center">
                    <span>ğŸš€ ç«‹å³å ±åé€å‡º</span>
                </button>
            </div>
        </form>

        <!-- é å°¾è¯çµ¡è³‡è¨Š -->
        <footer class="bg-gray-50/70 p-6 text-sm text-gray-600 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center rounded-b-3xl">
            <div class="mb-2 md:mb-0 flex items-center space-x-2">
                <span class="bg-indigo-100/80 text-indigo-700 px-2 py-1 rounded font-bold">ä¸»è¾¦å–®ä½</span>
                <span>å¥‡ç¾é†«é™¢æ•™å­¸éƒ¨</span>
            </div>
            <div class="flex items-center space-x-4">
                <span class="flex items-center"><span class="mr-1">ğŸ‘¤</span> è¯çµ¡äººï¼šé™³å¤§é ­</span>
                <span class="flex items-center"><span class="mr-1">ğŸ“</span> 06-281-2811 åˆ†æ©Ÿ 57112233</span>
            </div>
        </footer>
    </main>

    <!-- æˆåŠŸæç¤ºå½ˆå‡ºè¦–çª— (Modal) -->
    <div id="successModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-md opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl transform scale-95 transition-transform duration-300" id="modalContent">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">å ±åæˆåŠŸï¼</h3>
            <p class="text-gray-600 mb-6">æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„å ±åè³‡æ–™ï¼ŒæœŸå¾…åœ¨å·¥ä½œåŠèˆ‡æ‚¨ç›¸è¦‹ï¼</p>
            <button id="closeModalBtn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-md transition-colors w-full">
                é—œé–‰è¦–çª—
            </button>
        </div>
    </div>

    <script>
        // é€™è£¡å·²ç¶“æ›æˆæ‚¨å°ˆå±¬çš„ Google Apps Script ç¶²å€
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxengwZvIUcQ5JvJCUJIP2AmwBg8vabIHJeq6pehh3vhMlBEkebog7S7E6OU9piRGcZ/exec'; 

        const form = document.getElementById('registrationForm');
        const submitBtn = document.getElementById('submitBtn');

        // ==========================================
        // ç¶²é è¼‰å…¥æ™‚è‡ªå‹•æª¢æŸ¥å ±åäººæ•¸æ˜¯å¦é¡æ»¿
        // ==========================================
        window.addEventListener('DOMContentLoaded', () => {
            // å…ˆå°‡æŒ‰éˆ•è¨­ç‚ºæª¢æŸ¥ä¸­ç‹€æ…‹
            const originalBtnHtml = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span>â³ æ­£åœ¨æª¢æŸ¥åé¡...</span>';
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-75', 'cursor-wait');

            // ç™¼é€ GET è«‹æ±‚åˆ° Apps Script å–å¾—ç›®å‰åå–®
            fetch(scriptURL)
                .then(response => response.json())
                .then(result => {
                    if (result.result === 'success' && result.data) {
                        // éæ¿¾æ‰ç©ºç™½è¡Œï¼Œè¨ˆç®—å¯¦éš›å ±åäººæ•¸
                        const validData = result.data.filter(row => row['å§“å'] || row['æ©Ÿæ§‹å']);
                        
                        if (validData.length >= 4) {
                            // ã€å·²ç¶“é¡æ»¿ã€‘é–æ­»æŒ‰éˆ•ä¸¦æ”¹è®Šæ¨£å¼
                            submitBtn.innerHTML = '<span>ğŸš« æœ¬æ´»å‹•å·²é¡æ»¿ï¼Œåœæ­¢å ±å</span>';
                            submitBtn.classList.replace('from-pink-500', 'from-gray-500');
                            submitBtn.classList.replace('to-purple-600', 'to-gray-600');
                            submitBtn.classList.replace('hover:from-pink-600', 'hover:from-gray-600');
                            submitBtn.classList.replace('hover:to-purple-700', 'hover:to-gray-700');
                            submitBtn.classList.remove('cursor-wait');
                            submitBtn.classList.add('cursor-not-allowed');
                            submitBtn.disabled = true;

                            // æ›´æ”¹æœ€ä¸Šæ–¹æ©«å¹…æ–‡å­—ï¼Œæç¤ºä½¿ç”¨è€…å·²é¡æ»¿
                            const subtitle = document.querySelector('header p');
                            subtitle.innerHTML = 'âš ï¸ <span class="font-bold text-yellow-300 drop-shadow-md">æœ¬æ´»å‹•å ±åäººæ•¸å·²é”ä¸Šé™ï¼Œæ„Ÿè¬æ‚¨çš„æ”¯æŒï¼</span> âš ï¸';
                        } else {
                            // ã€å°šæœªé¡æ»¿ã€‘æ¢å¾©æŒ‰éˆ•åŸæœ¬ç‹€æ…‹
                            submitBtn.innerHTML = originalBtnHtml;
                            submitBtn.disabled = false;
                            submitBtn.classList.remove('opacity-75', 'cursor-wait');
                        }
                    } else {
                        submitBtn.innerHTML = originalBtnHtml;
                        submitBtn.disabled = false;
                        submitBtn.classList.remove('opacity-75', 'cursor-wait');
                    }
                })
                .catch(error => {
                    console.error('æª¢æŸ¥äººæ•¸ç™¼ç”ŸéŒ¯èª¤:', error);
                    submitBtn.innerHTML = originalBtnHtml;
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('opacity-75', 'cursor-wait');
                });
        });

        // è¡¨å–®æäº¤èˆ‡äº’å‹•é‚è¼¯
        form.addEventListener('submit', function(e) {
            e.preventDefault(); // é˜»æ­¢è¡¨å–®å¯¦éš›è·³è½‰
            
            const originalBtnHtml = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span>â³ è³‡æ–™å‚³é€ä¸­ï¼Œè«‹ç¨å€™...</span>';
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-75', 'cursor-not-allowed');

            const data = new URLSearchParams(new FormData(form));

            fetch(scriptURL, { method: 'POST', body: data, mode: 'no-cors' })
                .then(response => {
                    const modal = document.getElementById('successModal');
                    const modalContent = document.getElementById('modalContent');
                    modal.classList.remove('opacity-0', 'pointer-events-none');
                    modalContent.classList.remove('scale-95');
                    modalContent.classList.add('scale-100');
                    
                    form.reset(); 
                    submitBtn.innerHTML = '<span>ğŸ‰ å ±åå·²æˆåŠŸé€å‡º</span>';
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert('æŠ±æ­‰ï¼Œè³‡æ–™å‚³é€ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
                    submitBtn.innerHTML = originalBtnHtml;
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('opacity-75', 'cursor-not-allowed');
                });
        });

        // é—œé–‰ Modal ä¸¦é‡ç½®è¡¨å–®
        document.getElementById('closeModalBtn').addEventListener('click', function() {
            const modal = document.getElementById('successModal');
            const modalContent = document.getElementById('modalContent');
            
            modal.classList.add('opacity-0', 'pointer-events-none');
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('scale-95');
            
            // é—œé–‰è¦–çª—å¾Œé‡æ–°æ•´ç†ç¶²é ï¼Œè®“ç³»çµ±é‡æ–°æª¢æŸ¥æ˜¯å¦é¡æ»¿
            setTimeout(() => {
                window.location.reload();
            }, 300);
        });
    </script>
</body>
</html>
